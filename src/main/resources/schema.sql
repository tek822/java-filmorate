CREATE TABLE IF NOT EXISTS "FILMS"  (
  "FILM_ID" int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  "NAME" varchar (100),
  "DESCRIPTION" text,
  "RELEASEDATE" date NOT NULL,
  "DURATION" int,
  "RATING_ID" int
);

CREATE TABLE IF NOT EXISTS "USERS"  (
  "USER_ID" int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  "EMAIL" varchar(100),
  "NAME" varchar(100),
  "LOGIN" varchar(100),
  "BIRTHDAY" date NOT NULL
);

CREATE TABLE IF NOT EXISTS "FRIENDS"  (
  "USER_ID" int NOT NULL,
  "FRIEND_ID" int NOT NULL,
  "STATUS" boolean
);

CREATE TABLE IF NOT EXISTS "LIKES" (
  "FILM_ID" int NOT NULL,
  "USER_ID" int NOT NULL
);

CREATE TABLE IF NOT EXISTS "FILM_GENRES" (
  "FILM_ID" int NOT NULL,
  "GENRE_ID" int NOT NULL
);

CREATE TABLE IF NOT EXISTS "GENRES" (
  "GENRE_ID" int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  "GENRE" varchar(30)
);

CREATE TABLE IF NOT EXISTS "RATINGS" (
  "RATING_ID" int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  "RATING" varchar(30)
);

ALTER TABLE "FRIENDS" ADD CONSTRAINT IF NOT EXISTS FRIENDS_PK PRIMARY KEY ("USER_ID", "FRIEND_ID");

ALTER TABLE "FRIENDS" ADD CONSTRAINT IF NOT EXISTS FRIENDS_USERS_USER_ID_FK
    FOREIGN KEY ("USER_ID") REFERENCES "USERS" ("USER_ID") ON DELETE CASCADE;

ALTER TABLE "FRIENDS" ADD CONSTRAINT IF NOT EXISTS FRIENDS_USERS_FRIEND_ID_FK
    FOREIGN KEY ("FRIEND_ID") REFERENCES "USERS" ("USER_ID") ON DELETE CASCADE;

ALTER TABLE "LIKES" ADD CONSTRAINT IF NOT EXISTS LIKES_PK PRIMARY KEY ("FILM_ID", "USER_ID");

ALTER TABLE "LIKES" ADD CONSTRAINT IF NOT EXISTS LIKES_FILMS_FILM_ID_FK
      FOREIGN KEY ("FILM_ID") REFERENCES "FILMS" ("FILM_ID") ON  DELETE CASCADE;

ALTER TABLE "LIKES" ADD CONSTRAINT IF NOT EXISTS LIKES_USERS_USER_ID_FK
    FOREIGN KEY ("USER_ID") REFERENCES "USERS" ("USER_ID") ON DELETE CASCADE;

ALTER TABLE "FILM_GENRES" ADD CONSTRAINT IF NOT EXISTS FILM_GENRES_PK PRIMARY KEY ("FILM_ID", "GENRE_ID");

ALTER TABLE "FILM_GENRES" ADD CONSTRAINT IF NOT EXISTS FILM_GENRES_FILMS_FILM_ID_FK
    FOREIGN KEY ("FILM_ID") REFERENCES "FILMS" ("FILM_ID") ON DELETE CASCADE;

ALTER TABLE "FILM_GENRES" ADD CONSTRAINT IF NOT EXISTS FILM_GENRES_GENRES_GENRE_ID_FK
    FOREIGN KEY ("GENRE_ID") REFERENCES "GENRES" ("GENRE_ID") ON DELETE CASCADE;

ALTER TABLE "FILMS" ADD CONSTRAINT IF NOT EXISTS FILMS_RATINGS_RATING_ID_FK
    FOREIGN KEY ("RATING_ID") REFERENCES "RATINGS" ("RATING_ID") ON DELETE CASCADE;
